<!DOCTYPE html>
<html>

	<head>
		
<title>JVM-Welcome</title>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<link rel="shortcut icon" type="image/x-icon" href="/image/blog.svg">


<meta name="keywords" content="Java,Javaè™šæ‹Ÿæœº,GC,">
<meta name="description" content="Javaè™šæ‹Ÿæœºå…¥é—¨æ¡†æ¶">


<script src="/js/jquery.min.js"></script>



<!-- Baidu Analytics -->
<script defer>
    var _hmt = _hmt || [];
    (function () {
        var hm = document.createElement("script");
        hm.src = "https://hm.baidu.com/hm.js?4b5fe1472f22fa";
        var s = document.getElementsByTagName("script")[0];
        s.parentNode.insertBefore(hm, s);
    })();
</script>


	<meta name="generator" content="Hexo 5.4.0"></head>

	<body>
		
<link rel="stylesheet" href="/css/page.css">


<link rel="stylesheet" href="/css/page_cente.css">


<link rel="stylesheet" href="/css/atom-one-dark.css">


<link rel="stylesheet" href="/css/header.css">

	<div class="header">
		<div class="header-top">
			<div class="h-left">
				<a href="/">
					<img src="/image/robot.svg" alt="Quiet">
				</a>
			</div>
			<div class="h-right">
				<ul>
					
						
								<li>
									<a href="/">
										ä¸»é¡µ
									</a>
									<span class="dot"></span>
								</li>
								
									
						
								<li>
									<a href="/archives">
										å½’æ¡£
									</a>
									<span class="dot"></span>
								</li>
								
									
						
								<li>
									<a href="/categories">
										ç§ç±»
									</a>
									<span class="dot"></span>
								</li>
								
									
						
								<li>
									<a href="/tags">
										æ ‡ç­¾
									</a>
									<span class="dot"></span>
								</li>
								
									
						
								<li>
									<a href="/links">
										å‹æƒ…é“¾æ¥
									</a>
									<span class="dot"></span>
								</li>
								
									
						
								<li>
									<a href="/about">
										å…³äº
									</a>
									<span class="dot"></span>
								</li>
								
									
				</ul>
			</div>
			<div class="h-right-close">
				<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" width="24" height="24">
					<path fill="none" d="M0 0h24v24H0z" />
					<path d="M3 4h18v2H3V4zm0 7h18v2H3v-2zm0 7h18v2H3v-2z" fill="rgba(68,68,68,1)" />
				</svg>
			</div>
		</div>
	</div>
	<div class="sidebar">
    <div class="topo">
        <h2>Liar</h2>
    </div>
    <ul>
        
        <li>
            <a href="/">ä¸»é¡µ</a>
        </li>
        
        <li>
            <a href="/archives">å½’æ¡£</a>
        </li>
        
        <li>
            <a href="/categories">ç§ç±»</a>
        </li>
        
        <li>
            <a href="/tags">æ ‡ç­¾</a>
        </li>
        
        <li>
            <a href="/links">å‹æƒ…é“¾æ¥</a>
        </li>
        
        <li>
            <a href="/about">å…³äº</a>
        </li>
        
    </ul>
    <div class="my_foot">
        
        <a target="_blank" rel="noopener" href="https://github.com/newliar">
            <img src="https://cdn.jsdelivr.net/gh/duogongneng/MyBlogImg/imggithub.png" alt="Quietä¸»é¢˜">
        </a>
        
    </div>
</div>
<div class='shelter'
    style='cursor: pointer;display: none; position: fixed;left: 0;top: 0; right: 0;bottom: 0;background-color: #333;opacity:0.5;z-index: 108;'>
</div>
<style>
    .sidebar {
        width: 0;
        height: 100%;
        position: fixed;
        top: 0;
        right: 0;
        bottom: 0;
        background: #fff;
        z-index: 999;
        text-align: center;
        box-shadow: -6px 0 20px rgba(98, 94, 94, .815)
    }

    .topo {
        width: 100%;
        height: 200px;
        background: url(https://api.ixiaowai.cn/gqapi/gqapi.php) no-repeat;
        background-size: 100% 100%;
        position: relative;
        display: flex;
        align-items: flex-end
    }

    .topo h2 {
        color: #fff;
        z-index: 1;
        position: relative;
        margin: 0 0 10px 10px;
        font-size: 1.2em;
        box-sizing: border-box
    }

    .topo:before {
        content: '';
        background-image: url(/image/pattern.png);
        background-repeat: repeat;
        height: 100%;
        left: 0;
        position: absolute;
        top: 0;
        width: 100%;
        z-index: 1
    }

    .sidebar ul {
        width: 100%;
        margin-top: 50px
    }

    .sidebar ul li {
        height: 50px;
        list-style: none;
        font-size: 1.2em;
        text-align: right;
        margin-right: 10px
    }

    .sidebar ul li a {
        display: grid;
        color: #5d606a;
        text-overflow: ellipsis;
        width: 100%;
        text-decoration: none
    }

    .my_foot {
        width: 100%;
        padding: 10px;
        margin-bottom: 10px;
        position: absolute;
        bottom: 0
    }

    .my_foot a {
        text-decoration: none;
        margin-right: 10px;
        display: inline-block
    }

    .my_foot a img {
        width: 30px;
        height: 30px
    }
</style>

<script>
    $(function () { $('.h-right-close>svg').click(function () { $('.sidebar').animate({ width: "66%" }, 500); $('.shelter').fadeIn("slow") }); $('.shelter').click(function (e) { $('.sidebar').animate({ width: "0" }, 500); $('.shelter').fadeOut("slow") }) })
</script>
		<script>
			$(function () { $(window).scroll(function () { if ($(document).scrollTop() > 100) { $(".header-top").removeClass("header-move2"); $('.header-top').addClass('header-move1') } else { $(".header-top").removeClass("header-move1"); $('.header-top').addClass('header-move2') } }) });
		</script>
<div class="header-bg ">
    <div class="bg-content">
        <ul class="tag">
            
            
            <li><a href="/tags/Java">Java</a></li>
            
            <li><a href="/tags/Javaè™šæ‹Ÿæœº">Javaè™šæ‹Ÿæœº</a></li>
            
            <li><a href="/tags/GC">GC</a></li>
            
            
        </ul>
        <h1>JVM</h1>
        <div class="article-info">
            <div class="article-author">
                
                <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 20 20">
                    <g>
                        <path fill="#12183A"
                            d="M6.187 15.265A6.47 6.47 0 0 0 10 16.5a6.47 6.47 0 0 0 3.813-1.235A4.99 4.99 0 0 0 10 13.5a4.99 4.99 0 0 0-3.813 1.765zM5.082 14.25A6.485 6.485 0 0 1 10 12c1.965 0 3.726.872 4.918 2.25a6.5 6.5 0 1 0-9.836 0zM10 18a8 8 0 1 1 0-16 8 8 0 0 1 0 16zm0-7a3 3 0 1 1 0-6 3 3 0 0 1 0 6zm0-1.5a1.5 1.5 0 1 0 0-3 1.5 1.5 0 0 0 0 3z">
                        </path>
                    </g>
                </svg>
                
                <span> <a href="">Liar</a></span>
                <p>2021-08-05 15:41:31</p>
            </div>
        </div>
    </div>
</div>
<div class="article-content">
    <div id="article" class="content">
        <h1 id="JVMå…¥é—¨"><a href="#JVMå…¥é—¨" class="headerlink" title="JVMå…¥é—¨"></a>JVMå…¥é—¨</h1><h2 id="1-JVMçš„ä½ç½®"><a href="#1-JVMçš„ä½ç½®" class="headerlink" title="1.JVMçš„ä½ç½®"></a>1.JVMçš„ä½ç½®</h2><p><img src="/2021/08/05/JVM%E5%85%A5%E9%97%A8/image-20210805154206747.png" alt="image-20210805154206747"></p>
<h2 id="2-JVMçš„ä½“ç³»æ¶æ„"><a href="#2-JVMçš„ä½“ç³»æ¶æ„" class="headerlink" title="2.JVMçš„ä½“ç³»æ¶æ„"></a>2.JVMçš„ä½“ç³»æ¶æ„</h2><p><img src="/2021/08/05/JVM%E5%85%A5%E9%97%A8/image-20210805154218772.png" alt="image-20210805154218772"></p>
<blockquote>
<p>Javaæ ˆï¼Œæœ¬åœ°æ–¹æ³•æ ˆå’Œç¨‹åºè®¡æ•°å™¨ä¸ä¼šå­˜åœ¨åƒåœ¾å›æ”¶æœºåˆ¶</p>
</blockquote>
<p><img src="/2021/08/05/JVM%E5%85%A5%E9%97%A8/image-20210805154226413.png" alt="image-20210805154226413"></p>
<blockquote>
<p>JVMè°ƒä¼˜åŸºæœ¬åœ¨æ–¹æ³•åŒºå’Œå †é‡Œè°ƒä¼˜</p>
</blockquote>
<p><img src="/2021/08/05/JVM%E5%85%A5%E9%97%A8/image-20210805154235685.png" alt="image-20210805154235685"></p>
<h2 id="3-ç±»åŠ è½½å™¨-Class-Loader"><a href="#3-ç±»åŠ è½½å™¨-Class-Loader" class="headerlink" title="3.ç±»åŠ è½½å™¨    Class Loader"></a>3.ç±»åŠ è½½å™¨    Class Loader</h2><p>ä½œç”¨ï¼šåŠ è½½classæ–‡ä»¶</p>
<p><img src="/2021/08/05/JVM%E5%85%A5%E9%97%A8/image-20210805160213161.png" alt="image-20210805160213161"></p>
<figure class="highlight java"><table><tr><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Car</span> </span>&#123;<br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title">main</span><span class="hljs-params">(String[] args)</span> </span>&#123;<br>        Car car1 = <span class="hljs-keyword">new</span> Car();<br>        Car car2 = <span class="hljs-keyword">new</span> Car();<br>        Car car3 = <span class="hljs-keyword">new</span> Car();<br><br>        System.out.println(car1.hashCode());<br>        System.out.println(car2.hashCode());<br>        System.out.println(car3.hashCode());<br><br>        Class&lt;? extends Car&gt; aClass1 = car1.getClass();<br>        Class&lt;? extends Car&gt; aClass2 = car1.getClass();<br>        Class&lt;? extends Car&gt; aClass3 = car1.getClass();<br><br>        System.out.println(aClass1.hashCode());<br>        System.out.println(aClass2.hashCode());<br>        System.out.println(aClass3.hashCode());<br><br>        System.out.println(aClass1.getClassLoader());<br><br>    &#125;<br>&#125;<br><br><br>Outï¼š<br>å¯¹è±¡çš„å†…å­˜åœ°å€ä¸ä¸€æ ·<br><span class="hljs-number">460141958</span><br><span class="hljs-number">1163157884</span><br><span class="hljs-number">1956725890</span><br>ç±»çš„å†…å­˜åœ°å€ç›¸åŒ<br><span class="hljs-number">685325104</span><br><span class="hljs-number">685325104</span><br><span class="hljs-number">685325104</span><br>sun.misc.Launcher$AppClassLoader@18b4aac2<br></code></pre></td></tr></table></figure>

<p>ä»è¾“å‡ºç»“æœå¯ä»¥çœ‹å‡ºï¼Œåœ¨å®ä¾‹åŒ–å¯¹è±¡æ—¶ï¼Œæ¯ä¸ªå¯¹è±¡çš„å†…å­˜åœ°å€ä¸åŒï¼Œè€Œä»–ä»¬çš„æ¨¡æ¿ç±»æ˜¯åŒä¸€ä¸ªï¼Œä¸”æ ˆä¸­å­˜æ”¾å¯¹è±¡çš„å¼•ç”¨åœ°å€ï¼Œå¯¹è±¡çš„å…·ä½“æ•°æ®å­˜æ”¾åœ¨å †ä¸­ã€‚</p>
<p>ç±»åŠ è½½å™¨çš„ç§ç±»ï¼š</p>
<figure class="highlight java"><table><tr><td class="code"><pre><code class="hljs java">ClassLoader classLoader = aClass1.getClassLoader();<br>System.out.println(classLoader);<span class="hljs-comment">//AppClassLoader</span><br>System.out.println(classLoader.getParent());<span class="hljs-comment">//ExtClassLoader</span><br>System.out.println(classLoader.getParent().getParent());<span class="hljs-comment">//null</span><br></code></pre></td></tr></table></figure>

<p><img src="/2021/08/05/JVM%E5%85%A5%E9%97%A8/image-20210805160911193.png" alt="image-20210805160911193"></p>
<h2 id="4-åŒäº²å§”æ´¾æœºåˆ¶"><a href="#4-åŒäº²å§”æ´¾æœºåˆ¶" class="headerlink" title="4.åŒäº²å§”æ´¾æœºåˆ¶"></a>4.åŒäº²å§”æ´¾æœºåˆ¶</h2><p>åŒäº²å§”æ´¾æœºåˆ¶çš„å­˜åœ¨æ˜¯ä¸ºäº†javaç¨‹åºå®‰å…¨</p>
<p>javaä¸­é€šå¸¸æœ‰ä¸‰ä¸ªç±»åŠ è½½å™¨ï¼šAppClassLoaderâ€“&gt;ExtClassLoaderâ€“&gt;BootClassLoader</p>
<ol>
<li>ç±»åŠ è½½å™¨æ”¶åˆ°ç±»åŠ è½½è¯·æ±‚</li>
<li>å°†è¿™ä¸ªè¯·æ±‚å‘ä¸Šå§”æ‰˜ç»™çˆ¶ç±»åŠ è½½å™¨å»å®Œæˆï¼Œä¸€ç›´å‘ä¸Šå§”æ‰˜ï¼Œç›´åˆ°å¯åŠ¨ç±»åŠ è½½å™¨</li>
<li>å¯åŠ¨åŠ è½½å™¨æ£€æŸ¥æ˜¯å¦èƒ½å¤ŸåŠ è½½å½“å‰è¿™ä¸ªç±»ï¼Œèƒ½åŠ è½½å°±ç»“æŸï¼Œä½¿ç”¨å½“å‰çš„åŠ è½½å™¨ï¼Œå¦åˆ™æŠ›å‡ºå¼‚å¸¸ï¼Œé€šçŸ¥å­ç±»åŠ è½½å™¨åŠ è½½</li>
<li>é‡å¤æ­¥éª¤ä¸‰</li>
</ol>
<h2 id="5-æ²™ç®±å®‰å…¨æœºåˆ¶"><a href="#5-æ²™ç®±å®‰å…¨æœºåˆ¶" class="headerlink" title="5.æ²™ç®±å®‰å…¨æœºåˆ¶"></a>5.æ²™ç®±å®‰å…¨æœºåˆ¶</h2><h2 id="6-Native"><a href="#6-Native" class="headerlink" title="6.Native"></a>6.Native</h2><p>æœ¬åœ°æ–¹æ³•ä½¿ç”¨<code>native</code>å…³é”®å­—ï¼Œè¯´æ˜æ­¤æ–¹æ³•æ˜¯javaä½œç”¨èŒƒå›´å¤–çš„åŠŸèƒ½ï¼Œéœ€è¦è°ƒç”¨åº•å±‚Cè¯­è¨€çš„åº“æ¥å®ç°ã€‚</p>
<p>ä½¿ç”¨æœ¬åœ°æ–¹æ³•åï¼Œä¼šè¿›å…¥æœ¬åœ°æ–¹æ³•æ ˆï¼Œæœ¬åœ°æ–¹æ³•è°ƒç”¨æœ¬åœ°æ–¹æ³•æ¥å£<code>JNI</code>æ¥è°ƒç”¨åº•å±‚æ–¹æ³•</p>
<p>å¦‚çº¿ç¨‹å¯åŠ¨ï¼Œ<code>start()</code>æ–¹æ³•ä¼šè°ƒç”¨æœ¬åœ°æ–¹æ³•<code>native start0()</code>æ–¹æ³•</p>
<p><code>JNI(Java Native Interface)</code>çš„ä½œç”¨ï¼šæ‰©å±•Javaçš„ä½¿ç”¨ï¼Œèåˆä¸åŒçš„ç¼–ç¨‹è¯­è¨€ã€‚å¦‚Cã€C++ã€Python</p>
<h2 id="7-PCå¯„å­˜å™¨"><a href="#7-PCå¯„å­˜å™¨" class="headerlink" title="7.PCå¯„å­˜å™¨"></a>7.PCå¯„å­˜å™¨</h2><p><img src="/2021/08/05/JVM%E5%85%A5%E9%97%A8/image-20210806141146708.png" alt="image-20210806141146708"></p>
<h2 id="8-æ–¹æ³•åŒº"><a href="#8-æ–¹æ³•åŒº" class="headerlink" title="8.æ–¹æ³•åŒº"></a>8.æ–¹æ³•åŒº</h2><p>æ–¹æ³•åŒºæ˜¯è¢«æ‰€æœ‰çº¿ç¨‹å…±äº«çš„ç©ºé—´ï¼Œæ‰€æœ‰å­—æ®µå’Œæ–¹æ³•å­—èŠ‚ç ï¼Œä»¥åŠä¸€äº›ç‰¹æ®Šæ–¹æ³•ï¼Œå¦‚æ„é€ å‡½æ•°ï¼Œæ¥å£ä»£ç ä¹Ÿåœ¨æ­¤å®šä¹‰ã€‚æ‰€æœ‰å®šä¹‰çš„æ–¹æ³•çš„ä¿¡æ¯éƒ½å­˜åœ¨æ–¹æ³•åŒºã€‚</p>
<p>é™æ€å˜é‡ï¼ˆstaticï¼‰,å¸¸é‡ï¼Œç±»ä¿¡æ¯ï¼ˆæ„é€ æ–¹æ³•ã€æ¥å£å®šä¹‰ï¼‰ï¼Œè¿è¡Œæ—¶çš„å¸¸é‡æ± å­˜åœ¨æ–¹æ³•åŒºä¸­ï¼Œä½†æ˜¯å®ä¾‹å˜é‡å­˜åœ¨å †ä¸­ã€‚</p>
<p>static    final    Classï¼ˆç±»æ¨¡æ¿ä¿¡æ¯ï¼‰    å¸¸é‡æ±     éƒ½å­˜åœ¨æ–¹æ³•åŒº</p>
<h2 id="9-æ ˆ"><a href="#9-æ ˆ" class="headerlink" title="9.æ ˆ"></a>9.æ ˆ</h2><p>ç¨‹åºæ‰§è¡Œæ—¶ï¼Œå…ˆæŠŠ<code>main()</code>æ–¹æ³•å‹å…¥æ–¹æ³•æ ˆï¼Œå› æ­¤å¯ä»¥è§£é‡Š<code>main()</code>æ–¹æ³•æœ€å…ˆæ‰§è¡Œæœ€åç»“æŸ</p>
<p><code>stackOverflowError</code>å°±æ˜¯æ–¹æ³•æ ˆæº¢å‡ºï¼Œå¸¸è§ä¾‹å­å°±æ˜¯é€’å½’ç»ˆæ­¢æ¡ä»¶ä¸å¯¹å¯¼è‡´æ— é™å‹æ ˆæœ€ç»ˆæ ˆæº¢å‡º</p>
<p>çº¿ç¨‹ç»“æŸï¼Œæ ˆå†…å­˜ä¹Ÿå°±é‡Šæ”¾ï¼Œå¯¹äºæ ˆå†…å­˜æ¥è¯´ï¼Œ<strong>ä¸å­˜åœ¨åƒåœ¾å›æ”¶é—®é¢˜</strong></p>
<p>æ ˆå†…å­˜å­˜æ”¾çš„å†…å®¹ï¼š<strong>8å¤§åŸºæœ¬æ•°æ®ç±»å‹</strong>ï¼ˆint    short    long    float    double    byte    char    booleanï¼‰+<strong>å¯¹è±¡å¼•ç”¨</strong>+<strong>å®ä¾‹åŒ–çš„æ–¹æ³•</strong></p>
<p>ç¨‹åºæ­£åœ¨æ‰§è¡Œçš„æ–¹æ³•ï¼Œä¸€å®šåœ¨æ–¹æ³•æ ˆçš„<strong>é¡¶éƒ¨</strong></p>
<h2 id="10-ä¸‰ç§JVM"><a href="#10-ä¸‰ç§JVM" class="headerlink" title="10.ä¸‰ç§JVM"></a>10.ä¸‰ç§JVM</h2><p>Sunå…¬å¸HotSpot<code>Java HotSpot(TM) 64-Bit Server VM (build 25.221-b11, mixed mode)</code></p>
<p>BEA <code>JRockit</code></p>
<p>IBM <code>J9 VM</code></p>
<h2 id="11-å †"><a href="#11-å †" class="headerlink" title="11.å †"></a>11.å †</h2><p>Heapï¼Œä¸€ä¸ªJVMåªæœ‰ä¸€ä¸ªå †å†…å­˜ï¼Œä¸”å †å†…å­˜çš„å¤§å°å¯ä»¥è°ƒèŠ‚ã€‚</p>
<p>ç±»åŠ è½½å™¨è¯»å–äº†ç±»æ–‡ä»¶åï¼Œä¸€èˆ¬ä¼šæŠŠç±»çš„<strong>å®ä¾‹åŒ–ä¿¡æ¯ã€æ–¹æ³•ã€å¸¸é‡ã€å˜é‡</strong>æ”¾å…¥å †ä¸­ï¼Œä¿å­˜æ ˆä¸­å¼•ç”¨ç±»å‹çš„çœŸå®å¯¹è±¡</p>
<p>å †å†…å­˜åˆ†ä¸ºä¸‰ä¸ªåŒºåŸŸï¼š</p>
<ul>
<li>æ–°ç”ŸåŒºï¼ˆä¼Šç”¸å›­åŒº    Eden Spaceï¼‰</li>
<li>å…»è€åŒº</li>
<li>æ°¸ä¹…åŒº</li>
</ul>
<p><img src="/2021/08/05/JVM%E5%85%A5%E9%97%A8/image-20210806150843915.png"></p>
<p>GCåƒåœ¾å›æ”¶ä¸»è¦æ˜¯åœ¨<strong>ä¼Šç”¸å›­åŒº</strong>å’Œ<strong>å…»è€åŒº</strong> </p>
<p>åœ¨JDK8ä»¥åï¼Œæ°¸ä¹…å­˜å‚¨åŒºæ”¹äº†ä¸ªåå­—ï¼ˆå…ƒç©ºé—´ï¼‰</p>
<h2 id="12-æ–°ç”ŸåŒºã€è€å¹´åŒº"><a href="#12-æ–°ç”ŸåŒºã€è€å¹´åŒº" class="headerlink" title="12.æ–°ç”ŸåŒºã€è€å¹´åŒº"></a>12.æ–°ç”ŸåŒºã€è€å¹´åŒº</h2><p><strong>æ–°ç”ŸåŒº</strong></p>
<ul>
<li>ç±»ï¼šè¯ç”Ÿ    æˆé•¿ç”šè‡³æ­»äº¡çš„åœ°æ–¹</li>
<li>ä¼Šç”¸å›­ï¼Œæ‰€æœ‰å¯¹è±¡éƒ½æ˜¯åœ¨ä¼Šç”¸å›­newå‡ºæ¥çš„</li>
<li>å¹¸å­˜åŒºï¼ˆ0ï¼Œ1ï¼‰</li>
</ul>
<p><strong>è€å¹´åŒº</strong></p>
<p><img src="/2021/08/05/JVM%E5%85%A5%E9%97%A8/image-20210806151843446.png" alt="image-20210806151843446"></p>
<h2 id="13-æ°¸ä¹…åŒº"><a href="#13-æ°¸ä¹…åŒº" class="headerlink" title="13.æ°¸ä¹…åŒº"></a>13.æ°¸ä¹…åŒº</h2><p>è¿™ä¸ªåŒºåŸŸæ˜¯å¸¸é©»å†…å­˜çš„ã€‚ç”¨æ¥å­˜æ”¾JDKè‡ªèº«æºå¸¦çš„Classå¯¹è±¡ã€‚Interfaceå…ƒæ•°æ®ï¼Œå­˜å‚¨çš„æ˜¯Javaè¿è¡Œæ—¶çš„ä¸€äº›ç¯å¢ƒæˆ–ç±»ä¿¡æ¯ã€‚è¿™ä¸ªåŒºåŸŸä¸å­˜åœ¨åƒåœ¾å›æ”¶ï¼Œå…³é—­JVMå°±ä¼šé‡Šæ”¾æ­¤å¤„å†…å­˜ã€‚</p>
<ul>
<li>åœ¨JDK1.6ä¹‹å‰ï¼šå«æ°¸ä¹…ä»£ï¼Œå¸¸é‡æ± æ˜¯åœ¨æ–¹æ³•åŒº</li>
<li>jdk1.7ï¼šæ°¸ä¹…ä»£ï¼Œå¸¸é‡æ± åœ¨å †ä¸­</li>
<li>jdk1.8ï¼šæ— æ°¸ä¹…ä»£ï¼Œå¸¸é‡æ± åœ¨å…ƒç©ºé—´</li>
</ul>
<p><img src="/2021/08/05/JVM%E5%85%A5%E9%97%A8/image-20210806152902952.png" alt="å †å†…å­˜å›¾è§£"></p>
<h2 id="14-å †å†…å­˜è°ƒä¼˜"><a href="#14-å †å†…å­˜è°ƒä¼˜" class="headerlink" title="14.å †å†…å­˜è°ƒä¼˜"></a>14.å †å†…å­˜è°ƒä¼˜</h2><figure class="highlight java"><table><tr><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Demo02</span> </span>&#123;<br><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title">main</span><span class="hljs-params">(String[] args)</span> </span>&#123;<br>        <span class="hljs-comment">//è¿”å›è™šæ‹Ÿæœºè¯•å›¾ä½¿ç”¨çš„æœ€å¤§å†…å­˜</span><br>        <span class="hljs-keyword">long</span> max = Runtime.getRuntime().maxMemory();    <span class="hljs-comment">//å­—èŠ‚</span><br><br>        <span class="hljs-comment">//è¿”å›jvmçš„æ€»å†…å­˜</span><br>        <span class="hljs-keyword">long</span> total = Runtime.getRuntime().totalMemory();<br><br>        System.out.println(<span class="hljs-string">&quot;max=&quot;</span> + max + <span class="hljs-string">&quot;å­—èŠ‚\t&quot;</span> + (max / (<span class="hljs-keyword">double</span>) <span class="hljs-number">1024</span> / <span class="hljs-number">1024</span>)+<span class="hljs-string">&quot;MB&quot;</span>);<br>        System.out.println(<span class="hljs-string">&quot;total=&quot;</span> + total + <span class="hljs-string">&quot;å­—èŠ‚\t&quot;</span> + (total / (<span class="hljs-keyword">double</span>) <span class="hljs-number">1024</span> / <span class="hljs-number">1024</span>)+<span class="hljs-string">&quot;MB&quot;</span>);<br><br>    &#125;<br><br>&#125;<br><br><br>Outï¼š<br>    max=<span class="hljs-number">7618953216</span>å­—èŠ‚	<span class="hljs-number">7266.</span>0MB	ç”µè„‘æ€»å†…å­˜çš„<span class="hljs-number">1</span>/<span class="hljs-number">4</span><br>	total=<span class="hljs-number">514850816</span>å­—èŠ‚	<span class="hljs-number">491.</span>0MB		ç”µè„‘æ€»å†…å­˜çš„<span class="hljs-number">1</span>/<span class="hljs-number">64</span><br></code></pre></td></tr></table></figure>

<p>é»˜è®¤æƒ…å†µä¸‹ï¼Œåˆ†é…çš„æ€»å†…å­˜æ˜¯ç”µè„‘æ€»å†…å­˜çš„1/4ï¼Œåˆå§‹åŒ–å†…å­˜æ˜¯ç”µè„‘æ€»å†…å­˜çš„1/64</p>
<p><img src="/2021/08/05/JVM%E5%85%A5%E9%97%A8/image-20210806154241114.png" alt="image-20210806154241114"></p>
<p><code>-Xms</code>è®¾ç½®åˆå§‹åŒ–å†…å­˜åˆ†é…å¤§å°</p>
<p><code>-Xmx</code>è®¾ç½®æœ€å¤§åˆ†é…å†…å­˜</p>
<p><code>PrintGCDetails</code>æ‰“å°åƒåœ¾å›æ”¶ä¿¡æ¯</p>
<p><code>-Xms1024m -Xmx1024m -XX:+PrintGCDetails</code></p>
<p>æ”¹å˜åˆ†é…æ€»å†…å­˜å’Œåˆå§‹åŒ–å†…å­˜ï¼Œå¹¶æ‰“å°GCè¯¦ç»†ä¿¡æ¯</p>
<figure class="highlight shell"><table><tr><td class="code"><pre><code class="hljs shell">max=1029177344å­—èŠ‚	981.5MB<br>total=1029177344å­—èŠ‚	981.5MB<br>Heap<br> PSYoungGen      total 305664K, used 15729K [0x00000000eab00000, 0x0000000100000000, 0x0000000100000000)<br>  eden space 262144K, 6% used [0x00000000eab00000,0x00000000eba5c420,0x00000000fab00000)<br>  from space 43520K, 0% used [0x00000000fd580000,0x00000000fd580000,0x0000000100000000)<br>  to   space 43520K, 0% used [0x00000000fab00000,0x00000000fab00000,0x00000000fd580000)<br> ParOldGen       total 699392K, used 0K [0x00000000c0000000, 0x00000000eab00000, 0x00000000eab00000)<br>  object space 699392K, 0% used [0x00000000c0000000,0x00000000c0000000,0x00000000eab00000)<br> Metaspace       used 3125K, capacity 4496K, committed 4864K, reserved 1056768K<br>  class space    used 336K, capacity 388K, committed 512K, reserved 1048576K<br></code></pre></td></tr></table></figure>

<p><img src="/2021/08/05/JVM%E5%85%A5%E9%97%A8/image-20210806154609488.png" alt="image-20210806154609488"></p>
<p>æ–°ç”Ÿä»£+è€å¹´ä»£çš„å¤§å°ç­‰äºtotalå †å†…å­˜çš„å¤§å°</p>
<p>å› æ­¤å…ƒç©ºé—´é€»è¾‘ä¸Šå­˜åœ¨ï¼Œç‰©ç†ä¸Šä¸å­˜åœ¨ </p>
<p><code>java.lang.OutOfMemoryError: Java heap space</code>å †å†…å­˜æº¢å‡ºç¤ºä¾‹ğŸ‘‡</p>
<p>å…ˆå°†å †å†…å­˜è°ƒå°<code>-Xms1m -Xmx1m  -XX:+PrintGCDetails</code></p>
<figure class="highlight java"><table><tr><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">OOMError</span> </span>&#123;<br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title">main</span><span class="hljs-params">(String[] args)</span> </span>&#123;<br>        String str = <span class="hljs-string">&quot;abcdefg&quot;</span>;<br><br>        <span class="hljs-keyword">while</span> (<span class="hljs-keyword">true</span>) &#123;<br>            str += <span class="hljs-keyword">new</span> Random().nextInt(<span class="hljs-number">888888888</span>)+<span class="hljs-keyword">new</span> Random().nextInt(<span class="hljs-number">99999999</span>);<br>        &#125;<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure>

<img src="/2021/08/05/JVM%E5%85%A5%E9%97%A8/image-20210806155648260.png" alt="image-20210806155648260" style="zoom:200%;">

<img src="/2021/08/05/JVM%E5%85%A5%E9%97%A8/image-20210806155832939.png" alt="image-20210806155832939" style="zoom:200%;">

<p><strong>OOMæ•…éšœæ’æŸ¥</strong></p>
<ul>
<li>å†…å­˜å¿«ç…§å·¥å…·ï¼šJprofilerã€MATï¼ˆå·¥å…·å¯ä»¥å¿«é€Ÿå®šä½å†…å­˜æ³„æ¼ä½ç½®ï¼‰</li>
<li>Debug</li>
</ul>
<p><strong>Dumpå¼‚å¸¸</strong></p>
<p><code>HeapDumpOnOutOfMemoryError</code>å½“å‘ç”ŸOOMé”™è¯¯æ—¶dumpæ–‡ä»¶</p>
<p><img src="/2021/08/05/JVM%E5%85%A5%E9%97%A8/image-20210806162544304.png" alt="image-20210806162544304"></p>
<p><img src="/2021/08/05/JVM%E5%85%A5%E9%97%A8/image-20210806162750907.png" alt="image-20210806162750907"></p>
<p>jProfilerè¯¦ç»†ä¿¡æ¯</p>
<p><img src="/2021/08/05/JVM%E5%85%A5%E9%97%A8/image-20210806162823170.png" alt="image-20210806162823170"></p>
<h2 id="15-GCâ€”â€”åƒåœ¾å›æ”¶"><a href="#15-GCâ€”â€”åƒåœ¾å›æ”¶" class="headerlink" title="15.GCâ€”â€”åƒåœ¾å›æ”¶"></a>15.GCâ€”â€”åƒåœ¾å›æ”¶</h2><p><img src="/2021/08/05/JVM%E5%85%A5%E9%97%A8/image-20210806164024761.png" alt="image-20210806164024761"></p>
<p>JVMåœ¨GCæ—¶ï¼Œå¹¶ä¸æ˜¯å¯¹ä¸‰ä¸ªåŒºåŸŸç»Ÿä¸€å›æ”¶ã€‚å¤§éƒ¨åˆ†æ—¶å€™ï¼Œå›æ”¶éƒ½æ˜¯æ–°ç”Ÿä»£</p>
<ul>
<li>æ–°ç”Ÿä»£</li>
<li>å¹¸å­˜åŒº</li>
<li>è€å¹´åŒº</li>
</ul>
<p>GCä¸¤ç§ï¼šè½»GCï¼Œé‡GC</p>
<p><strong>GCå¸¸è§é¢˜ç›®</strong></p>
<p><img src="/2021/08/05/JVM%E5%85%A5%E9%97%A8/image-20210806164834825.png" alt="image-20210806164834825"></p>
<p><strong>GCç®—æ³•</strong></p>
<p>å¼•ç”¨è®¡æ•°æ³•ï¼ˆç”¨å¾—å°‘ï¼‰</p>
<p><img src="/2021/08/05/JVM%E5%85%A5%E9%97%A8/image-20210806165224705.png" alt="image-20210806165224705"></p>
<p><strong>å¤åˆ¶ç®—æ³•</strong></p>
<p><img src="/2021/08/05/JVM%E5%85%A5%E9%97%A8/image-20210806171020246.png" alt="image-20210806171020246"></p>
<p>æ¯æ¬¡GCéƒ½ä¼šå°†EdenåŒºæ´»çš„å¯¹è±¡è½¬ç§»åˆ°å¹¸å­˜åŒºï¼šä¸€æ—¦EdenåŒºè¢«GCåï¼Œå°±ä¼šæ˜¯ç©ºçš„ã€‚</p>
<p>å…³äº<strong>å¹¸å­˜åŒºfrom</strong>å’Œ<strong>å¹¸å­˜åŒºto</strong>ï¼Œä¸¤ä¸ªå¹¸å­˜åŒºæ˜¯ä¸€ç›´åœ¨<strong>ç›¸äº’è½¬ç§»</strong>çš„ï¼Œæ¯æ¬¡GCåï¼ŒEdenåŒºä¼šå°†æ´»ç€çš„å¯¹è±¡è½¬ç§»åˆ°å¹¸å­˜åŒºtoä¸­ï¼ŒåŒæ—¶å¹¸å­˜åŒºfromä¼šå°†å…¶ä¸­å¯¹è±¡å¤åˆ¶åˆ°å¹¸å­˜åŒºtoä¸­ï¼Œå¹¶å°†è‡ªèº«æ¸…ç©ºã€‚æ­¤æ—¶å¹¸å­˜åŒºtoä¹Ÿå°±è½¬æ¢æˆäº†å¹¸å­˜åŒºfromï¼Œå¹¸å­˜åŒºfromåŒæ—¶è½¬æ¢æˆäº†å¹¸å­˜åŒºtoã€‚ï¼ˆè°ç©ºè°æ˜¯toï¼‰</p>
<p>å½“ä¸€ä¸ªå¯¹è±¡ç»å†äº†15æ¬¡GCåéƒ½è¿˜æ²¡æ­»ï¼Œå°±ä¼šä¼ å…¥è€å¹´ä»£ï¼ˆé»˜è®¤æƒ…å†µï¼‰</p>
<p>é€šè¿‡<code>-XX:MaxTenuringThreshold=5</code>æ¥æ”¹å˜è¿›å…¥è€å¹´ä»£çš„æ—¶é—´ã€‚</p>
<p><img src="/2021/08/05/JVM%E5%85%A5%E9%97%A8/image-20210806170941763.png" alt="image-20210806170941763"></p>
<ul>
<li>å¥½å¤„ï¼šæ²¡æœ‰å†…å­˜ç¢ç‰‡</li>
<li>åå¤„ï¼šæµªè´¹äº†å†…å­˜ç©ºé—´ï¼Œå¤šäº†ä¸€åŠæ°¸è¿œæ˜¯ç©ºtoã€‚å¦‚æœå¯¹è±¡éƒ½100%å­˜æ´»ï¼Œå¤åˆ¶ç®—æ³•å¼€é”€æå¤§</li>
</ul>
<p><strong>å¤åˆ¶ç®—æ³•æœ€ä½³ä½¿ç”¨åœºæ™¯ï¼šå¯¹è±¡å­˜æ´»åº¦è¾ƒä½çš„æ—¶å€™</strong>â€”â€”<strong>æ–°ç”ŸåŒº</strong></p>
<p><strong>æ ‡è®°æ¸…é™¤ç®—æ³•</strong></p>
<p><img src="/2021/08/05/JVM%E5%85%A5%E9%97%A8/image-20210809150046621.png" alt="image-20210809150046621"></p>
<ul>
<li>ä¼˜ç‚¹ï¼šä¸éœ€è¦é¢å¤–ç©ºé—´</li>
<li>ç¼ºç‚¹ï¼šä¸¤æ¬¡æ‰«æï¼Œä¸¥é‡æµªè´¹æ—¶é—´ï¼Œä¼šäº§ç”Ÿå†…å­˜ç¢ç‰‡ã€‚</li>
</ul>
<p>æ ‡è®°å‹ç¼©ç®—æ³•</p>
<p><img src="/2021/08/05/JVM%E5%85%A5%E9%97%A8/image-20210809150535856.png" alt="image-20210809150535856"></p>
<p>å¯¹äºæ ‡è®°æ¸…é™¤çš„ä¼˜åŒ–ï¼Œé˜²æ­¢å†…å­˜ç¢ç‰‡äº§ç”Ÿï¼Œä½†æ˜¯å¤šäº†ä¸€æ¬¡ç§»åŠ¨æˆæœ¬</p>
<h3 id="æ€»ç»“"><a href="#æ€»ç»“" class="headerlink" title="æ€»ç»“"></a>æ€»ç»“</h3><ul>
<li>å†…å­˜æ•ˆç‡ï¼šå¤åˆ¶ç®—æ³•&gt;æ ‡è®°æ¸…é™¤ç®—æ³•&gt;æ ‡è®°å‹ç¼©ç®—æ³•ï¼ˆæ—¶é—´å¤æ‚åº¦ï¼‰</li>
<li>å†…å­˜æ•´é½åº¦ï¼šå¤åˆ¶ç®—æ³•=æ ‡è®°å‹ç¼©ç®—æ³•&gt;æ ‡è®°æ¸…é™¤ç®—æ³•</li>
<li>å†…å­˜åˆ©ç”¨ç‡ï¼šæ ‡è®°å‹ç¼©ç®—æ³•=æ ‡è®°æ¸…é™¤ç®—æ³•&gt;å¤åˆ¶ç®—æ³• </li>
</ul>
<p>GCä¹Ÿå«<strong>åˆ†ä»£æ”¶é›†ç®—æ³•</strong></p>
<p>å¹´è½»ä»£ï¼šå­˜æ´»ç‡ä½ â†’ å¤åˆ¶ç®—æ³•</p>
<p>è€å¹´ä»£ï¼šåŒºåŸŸå¤§ï¼Œå­˜æ´»ç‡é«˜ â†’ æ ‡è®°æ¸…é™¤ + æ ‡è®°å‹ç¼© æ··åˆå®ç°</p>
<h3 id="16-JMMï¼šJava-Memory-Model"><a href="#16-JMMï¼šJava-Memory-Model" class="headerlink" title="16.JMMï¼šJava Memory Model"></a>16.JMMï¼šJava Memory Model</h3>
    </div>
</div>
<style>
    #noneimg img {
        display: none;
        z-index: 109;
        width: 600px !important;
        border-radius: 0px;
        position: fixed;
        box-shadow: 0 0 0px #c3c3c300 !important;
        left: 0;
        top: 0;
        right: 0;
        bottom: 0;
        margin: auto !important;
    }

    @media screen and (max-width:600px) {
        #noneimg img {
            width: 88%
        }
    }
</style>
<script>
    $(function () { $('#article').click(function (e) { if (e.target.tagName == "IMG") { if ($('#nonediv').length == 0) { let MImg = `<div id='noneimg'><img src='${e.target.currentSrc}'></div>`; let MDiv = "<div id='nonediv' style='cursor: pointer;display: none; position: fixed;left: 0;top: 0; right: 0;bottom: 0;background-color: #333;opacity:0.5;z-index: 108;'></div>"; $('#article').append(MDiv); $('#article').append(MImg); $("#nonediv").fadeIn("slow"); $("#noneimg img").fadeIn("slow") } } else { if ($('#nonediv').length !== 0) { $("#noneimg ").fadeOut("slow"); $("#nonediv").fadeOut("slow"); setTimeout(function () { $('#nonediv').remove(); $('#noneimg').remove() }, 500) } } }); $('.article-content').addClass('content-move') });
</script>
<div class="Last-Next">
    

    
    <a href="/2021/08/05/%E5%8F%8D%E5%B0%84/">
        <div class="next">
            <span>ä¸‹ä¸€ç¯‡</span>
            <p>åå°„</p>
        </div>
    </a>
    
</div>
		
<link rel="stylesheet" href="/css/food.css">

<div class="footer">
	<div class="Copyright">
		Â©2021 By Liar
	</div>
	<div class="contact">
		
		<a target="_blank" rel="noopener" href="https://github.com/newliar">
			<img src="https://cdn.jsdelivr.net/gh/duogongneng/MyBlogImg/imggithub.png" alt="Quietä¸»é¢˜">
		</a>
		
	</div>
</div>

<script src="/js/jquery.min.js"></script>


<script src="/js/gotop.js"></script>


<style type="text/css">
    @media screen and (min-width: 600px) {
        .goTop>span {
            display: block;
            border-radius: 50%;
            width: 66px;
            height: 66px;
            cursor: pointer;
            opacity: 0.8;
            background: rgba(18, 24, 58, 0.06);
            text-align: center;
            border: 1px solid rgba(18, 24, 58, 0.06);

            transition: border .5s;
            -moz-transition: border .5s;
            /* Firefox 4 */
            -webkit-transition: border .5s;
            /* Safari å’Œ Chrome */
            -o-transition: border .5s;
            /* Opera */
        }

        .goTop>span:hover {
            border: 1px solid #6680B3;
        }


        .goTop {
            position: fixed;
            right: 30px;
            bottom: 80px;
        }

        .goTop>span>svg {
            width: 30px;
            height: 30px;
            margin-top: 17.5px;
            opacity: 0.7;
        }

    }

    @media screen and (max-width: 600px) {
        .goTop {
            display: none;
        }
    }
</style>
<div class="goTop" id="js-go_top">
    <span>
        <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24">
            <g>
                <path d="M13 12v8h-2v-8H4l8-8 8 8z"></path>
            </g>
        </svg>
    </span>
</div>
<script>
    $('#js-go_top').gotoTop({ offset: 500, speed: 300, animationShow: { 'transform': 'translate(0,0)', 'transition': 'transform .5s ease-in-out' }, animationHide: { 'transform': 'translate(100px,0)', 'transition': 'transform .5s ease-in-out' } });
</script>
	</body>

</html>